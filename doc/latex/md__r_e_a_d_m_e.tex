\chapter{ğŸ® Un jeu vidÃ©o \+: Tetris }
\hypertarget{md__r_e_a_d_m_e}{}\label{md__r_e_a_d_m_e}\index{ğŸ®  Un jeu vidÃ©o : Tetris@{ğŸ®  Un jeu vidÃ©o : Tetris}}
\label{md__r_e_a_d_m_e_autotoc_md0}%
\Hypertarget{md__r_e_a_d_m_e_autotoc_md0}%


Un jeu Tetris classique dÃ©veloppÃ© en C++ et avec un interface graphique et sonore disponible sur \href{https://github.com/bonaventuredk/Tetris}{\texttt{https\+://github.\+com/bonaventuredk/\+Tetris}}.\hypertarget{md__r_e_a_d_m_e_autotoc_md1}{}\doxysection{\texorpdfstring{Auteurs \+:}{Auteurs \+:}}\label{md__r_e_a_d_m_e_autotoc_md1}
\begin{DoxyVerb}* Alexandre Bleuler 
* Bonaventure Dohemeto
\end{DoxyVerb}
\hypertarget{md__r_e_a_d_m_e_autotoc_md2}{}\doxysection{\texorpdfstring{Table des MatiÃ¨res}{Table des MatiÃ¨res}}\label{md__r_e_a_d_m_e_autotoc_md2}

\begin{DoxyItemize}
\item Description gÃ©nÃ©rale du jeu Tetris
\item TÃ©lÃ©chargement, installation et dÃ©pendances
\item Jouer au jeu
\item Description des fonctionnalitÃ©s du jeu
\item ImplÃ©mentation du jeu
\item Documentation
\item Tests
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md3}{}\doxysection{\texorpdfstring{Description gÃ©nÃ©rale du jeu Tetris}{Description gÃ©nÃ©rale du jeu Tetris}}\label{md__r_e_a_d_m_e_autotoc_md3}
Tetris est un cÃ©lÃ¨bre jeu-\/vidÃ©o dont le but est d\textquotesingle{}obtenir le meilleur score possible en remplissant des lignes de blocs dans une grille.

Pour ce faire, des piÃ¨ces composÃ©es de quatre blocs (voir image ci-\/dessous) tombent depuis le haut de la grille et le joueur doit les dÃ©placer pour les poser Ã  l\textquotesingle{}endroit qu\textquotesingle{}il juge le plus appropriÃ©. Les dÃ©placements possible sont vers le bas, la gauche et la droite. Des rotations horaires et anti-\/horaires sont Ã©galement possibles.

Lorsqu\textquotesingle{}une ligne est remplie, elle disparaÃ®t et les lignes du dessus descendent d\textquotesingle{}un cran. Si aprÃ¨s disparition des lignes pleines un bloc de trouve toujours dans l\textquotesingle{}une des quatre plus hautes lignes de la grille, la partie est perdue !

\begin{center} $<$figure$>$  $<$/figure$>$ \end{center} \hypertarget{md__r_e_a_d_m_e_autotoc_md4}{}\doxysection{\texorpdfstring{TÃ©lÃ©chargement, installation et dÃ©pendances}{TÃ©lÃ©chargement, installation et dÃ©pendances}}\label{md__r_e_a_d_m_e_autotoc_md4}
Le jeu peut-\/Ãªtre tÃ©lÃ©chargÃ© ici \+: \href{https://github.com/bonaventuredk/Tetris}{\texttt{https\+://github.\+com/bonaventuredk/\+Tetris}}.

Pour ce qui est de l\textquotesingle{}installation du jeu, celle-\/ci est conÃ§ue pour Ãªtre rÃ©alisÃ©e Ã  l\textquotesingle{}aide de {\ttfamily CMake}, de prÃ©fÃ©rence dans un dossier {\ttfamily /build} Ã  la racine du dossier de tÃ©lÃ©chargement. Un fichier {\ttfamily CMake\+Lists.\+txt} est notamment fourni Ã  cette fin. Une faÃ§on de de faire cela est d\textquotesingle{}utiliser dans un terminal Ã  la racine du dossier de tÃ©lÃ©chargement les commandes \+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir\ build}
\DoxyCodeLine{cd\ build}
\DoxyCodeLine{cmake\ ..}

\end{DoxyCode}


De petites adaptations en fonction du systÃ¨me d\textquotesingle{}exploitation utilisÃ© devront Ã©ventuellement Ãªtre faites, notamment en ce qui concerne les dÃ©pendances suivantes qui doivent prÃ©alablement Ãªtre installÃ©es et trouvables par {\ttfamily CMake} \+:
\begin{DoxyItemize}
\item la librairie {\ttfamily Catch2 version 3 (32 bits)};
\item la librairie {\ttfamily SFML version 3.\+0.\+2. (64 bits)}.
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md5}{}\doxysection{\texorpdfstring{Jouer au jeu}{Jouer au jeu}}\label{md__r_e_a_d_m_e_autotoc_md5}
Une fois l\textquotesingle{}installation rÃ©alisÃ©e, il suffit alors d\textquotesingle{}exÃ©cuter le fichier {\ttfamily tetrix\+\_\+game}. Ce fichier se trouve Ã  la racine de l\textquotesingle{}installation faite via {\ttfamily CMake} (donc dans le dossier {\ttfamily /build} avec les instructions prÃ©cÃ©dentes). Une fenÃªtre en plein Ã©cran s\textquotesingle{}ouvrira alors et vous proposera notamment de lancer une partie ou de quitter le jeu.

Au cours d\textquotesingle{}une partie, les touches du clavier utilisables seront \+:
\begin{DoxyItemize}
\item {\ttfamily left arrow} pour bouger la piÃ¨ce vers la gauche;
\item {\ttfamily right arrow} pour bouger la piÃ¨ce vers la droite;
\item {\ttfamily down arrow} pour bouger la piÃ¨ce vers le bas;
\item {\ttfamily up arrow} pour faire une rotation de la piÃ¨ce dans le sens anti-\/horaire;
\item {\ttfamily space} pour faire une rotation de la piÃ¨ce dans le sens horaire;
\item et {\ttfamily P} pour mettre le jeu sur pause.
\end{DoxyItemize}

Finalement, mentionnons qu\textquotesingle{}un mouvement qui ferait sortir la piÃ¨ce de la grille de jeu ne sera pas comptabilisÃ©.\hypertarget{md__r_e_a_d_m_e_autotoc_md6}{}\doxysection{\texorpdfstring{Description des fonctionnalitÃ©s du jeu}{Description des fonctionnalitÃ©s du jeu}}\label{md__r_e_a_d_m_e_autotoc_md6}
Outre la rÃ©alisation et la mise Ã  l\textquotesingle{}Ã©cran des Ã©lÃ©ments clÃ©s du jeu dÃ©crits au paragraphe Description du jeu Tetris , le jeu fournit plusieurs menus qui permettent de lancer une nouvelle partie ou de quitter le jeu \+: un menu au dÃ©marrage du jeu, un menu pause permettant de figer l\textquotesingle{}Ã©tat de la partie et enfin un menu de fin de partie.

Ã‰galement, un affichage de la prochaine piÃ¨ce Ã  jouer est rÃ©alisÃ© Ã  droite de la grille du jeu. A sa gauche, l\textquotesingle{}affichage du score de la partie actuelle est Ã©galement affichÃ© de mÃªme que le meilleur score jamais rÃ©alisÃ© pour cette installation du jeu.

FInalement, en plus des diverses touches du clavier permettant de jouer au jeu, des effets sonores ainsi que des musiques d\textquotesingle{}ambiance ont Ã©tÃ© ajoutÃ©s. Cependant, le jeu ne possÃ¨de pas de rÃ©glage interne du son. Celui-\/ci doit donc Ãªtre ajustÃ© directement avec le mÃ©langeur de volumes de l\textquotesingle{}ordinateur. En particulier, il est recommandÃ© de faire attention Ã  la puissance du son lors du premier lancement du jeu, celui-\/ci pourrait Ãªtre trop fort en l\textquotesingle{}absence de rÃ©glages prÃ©alables.\hypertarget{md__r_e_a_d_m_e_autotoc_md7}{}\doxysection{\texorpdfstring{ImplÃ©mentation du jeu}{ImplÃ©mentation du jeu}}\label{md__r_e_a_d_m_e_autotoc_md7}
\hypertarget{md__r_e_a_d_m_e_autotoc_md8}{}\doxysubsection{\texorpdfstring{Aborescence des fichiers}{Aborescence des fichiers}}\label{md__r_e_a_d_m_e_autotoc_md8}
\begin{DoxyVerb}    TetrisProject/
    â”‚
    â”œâ”€â”€â”€ core/
    â”‚ â”œâ”€â”€â”€ include/
    â”‚ â”‚ â””â”€â”€â”€ core_class.h
    â”‚ â””â”€â”€â”€ src/
    â”‚   â”œâ”€â”€â”€ core_class.cpp
    â”‚   â””â”€â”€â”€ main.cpp
    â”‚
    â”œâ”€â”€â”€ doc/
    â”‚
    â”œâ”€â”€â”€ tests/
    â”‚ â””â”€â”€â”€ test_core_class.cpp

    â”œâ”€â”€â”€ ui/
    â”‚ â”œâ”€â”€â”€ include/
    â”‚ â”‚ â””â”€â”€â”€ ui.h
    â”‚ â”œâ”€â”€â”€ src/
    â”‚ â”‚ â””â”€â”€â”€ ui.cpp
    â”‚ â”œâ”€â”€â”€ sound/
    â”‚ â”‚ â”œâ”€â”€â”€ anticlockwise.wav
    â”‚ â”‚ â”œâ”€â”€â”€ clickleft.wav
    â”‚ â”‚ â”œâ”€â”€â”€ clickright.wav
    â”‚ â”‚ â”œâ”€â”€â”€ clockwise.wav
    â”‚ â”‚ â”œâ”€â”€â”€ drop.wav
    â”‚ â”‚ â”œâ”€â”€â”€ game_over.wav
    â”‚ â”‚ â”œâ”€â”€â”€ higherlevelup.wav
    â”‚ â”‚ â”œâ”€â”€â”€ music.ogg
    â”‚ â”‚ â””â”€â”€â”€ success_linedisapear.wav
    â”‚ â””â”€â”€â”€ Tetris_font.ttf
    â”‚
    â”œâ”€â”€â”€ .gitignore
    â”œâ”€â”€â”€ CMakeLists.txt
    â”œâ”€â”€â”€ DoxyFile
    â”œâ”€â”€â”€ README.md
    â””â”€â”€â”€ tetrominoes_notations.png
\end{DoxyVerb}
\hypertarget{md__r_e_a_d_m_e_autotoc_md9}{}\doxysubsection{\texorpdfstring{BrÃ¨ve description du core}{BrÃ¨ve description du core}}\label{md__r_e_a_d_m_e_autotoc_md9}
Le dossier {\ttfamily /core} contient les fichiers permettant de de dÃ©finir la logique du jeu.

En particulier, les fichiers {\ttfamily \doxylink{core__class_8cpp}{core\+\_\+class.\+cpp}} et {\ttfamily \doxylink{core__class_8h}{core\+\_\+class.\+h}} contiennent respectivement les dÃ©finitions et dÃ©clarations des quatre classes constituant le coeur de l\textquotesingle{}implÃ©mentation \+:
\begin{DoxyItemize}
\item {\ttfamily \doxylink{class_block}{Block}}
\item {\ttfamily \doxylink{class_piece}{Piece}}
\item {\ttfamily \doxylink{class_cell}{Cell}}
\item {\ttfamily \doxylink{class_grid}{Grid}}
\end{DoxyItemize}

{\ttfamily \doxylink{class_block}{Block}} est essentiellement un couple de coordonnÃ©es entiÃ¨res positives et sur lequel l\textquotesingle{}on peut faire des translations Ã  partir du mouvement dÃ©crit tel qu\textquotesingle{}il apparaÃ®trait sur un Ã©cran. {\ttfamily \doxylink{class_piece}{Piece}} est alors un agrÃ©gat de quatre blocs dont les positions relatives permettent de dÃ©finir les formes dÃ©crites au paragraphe Description gÃ©nÃ©rale du jeu Tetris. Une piÃ¨ce possÃ¨de Ã©galement une mÃ©thode permettant de rÃ©aliser les mÃªmes types de mouvement que les blocs auxquels on ajoute les rotations horaires et anti-\/horaires autour d\textquotesingle{}un bloc pivot dÃ©finit prÃ©alablement.

La classe {\ttfamily \doxylink{class_cell}{Cell}} est quant Ã  elle une classe rÃ©prÃ©sentant les cases d\textquotesingle{}une grille de jeu Tetris. Elle contient donc des attributs et mÃ©thodes donnant des informations sur la case \+: sa couleur et si elle est vide ou non. La classe {\ttfamily \doxylink{class_grid}{Grid}} est alors un grille d\textquotesingle{}objets de type {\ttfamily \doxylink{class_cell}{Cell}} et est l\textquotesingle{}interface du core du jeu. En particulier, une partie de Tetris est constituÃ© d\textquotesingle{}itÃ©rations du type \+:
\begin{DoxyItemize}
\item la crÃ©ation de la prochaine piÃ¨ce Ã  jouer et son positionnement (mÃ©thode {\ttfamily put\+\_\+piece} de {\ttfamily \doxylink{class_grid}{Grid}}) ;
\item le dÃ©placement de la piÃ¨ce jusqu\textquotesingle{}Ã  qu\textquotesingle{}elle ne puisse plus descendre (mÃ©thode {\ttfamily move\+\_\+piece} de {\ttfamily \doxylink{class_grid}{Grid}}) ;
\item la mise Ã  jour de la grille avec la suppression des lignes pleines et la vÃ©rification de la fin de partie (mÃ©thode {\ttfamily update} de {\ttfamily \doxylink{class_grid}{Grid}}).
\end{DoxyItemize}

PrÃ©cisons en outre le lien entre une piÃ¨ce et une grilles. En effet, il s\textquotesingle{}avÃ¨re que la piÃ¨ce contrÃ´lÃ©e par le joueur n\textquotesingle{}Ã©volue pas directement dans la grille. Elle existe plutÃ´t sÃ©parÃ©ment et la grille actualise ses cellules en mettant en parallÃ¨le les coordonnÃ©es des blocks de la piÃ¨ce et les index des cellules.

Le premier avantage de cela est que cela facilite la vÃ©rification de la lÃ©galitÃ© des mouvements de la piÃ¨ce. En effet, il faut que pendant une partie de Tetris la piÃ¨ce ne sorte pas de la grille. La piÃ¨ce ayant une existence indÃ©pendante de la grille, nous pouvons donc la dÃ©placer sans s\textquotesingle{}en prÃ©occuper dans un premier temps. Il est alors facile dans un second temps de vÃ©rifier en regardant directement les coordonnÃ©es des blocs de la piÃ¨ce si celles-\/ci correspondent Ã  des indices possibles de la grille et si les cellules correspondantes sont bien vides. Si ces deux choses sont vÃ©rifiÃ©es, le dÃ©placement de la piÃ¨ce est validÃ©, sinon la piÃ¨ce est remise Ã  sa position initiale. De cette faÃ§on, si l\textquotesingle{}affichage graphique de l\textquotesingle{}Ã©tat de la grille est rÃ©alisÃ© aprÃ¨s ces Ã©tapes, la piÃ¨ce ne se sera pas dÃ©placÃ©e pour le joueur en cas de mouvement illÃ©gal.

Le deuxiÃ¨me avantage est que cela n\textquotesingle{}oblige pas Ã  stocker les piÃ¨ces tout au long de la partie mais juste Ã  changer le caractÃ¨re vide ou plein des cellules de la grille au fur et mesure. Il s\textquotesingle{}agit donc essentiellement de stocker un boolÃ©en au lieu d\textquotesingle{}un couple de {\ttfamily unsigned int}, ce qui est plus efficace en terme de mÃ©moire.

Finalement, le core du jeu contient Ã©galement le fichier {\ttfamily \doxylink{main_8cpp}{main.\+cpp}} qui est comme son nom l\textquotesingle{}indique le fichier contenant la fonction {\ttfamily main}. II s\textquotesingle{}agit du fichier organisant l\textquotesingle{}ensemble du jeu, notamment en reliant l\textquotesingle{}interface du core, les objets de type {\ttfamily \doxylink{class_grid}{Grid}} gÃ©rant la logique interne du jeu, Ã  l\textquotesingle{}interface utilisateur permettant par exemple d\textquotesingle{}afficher le jeu Ã  l\textquotesingle{}Ã©cran tel qu\textquotesingle{}attendu.\hypertarget{md__r_e_a_d_m_e_autotoc_md10}{}\doxysubsection{\texorpdfstring{BrÃ¨ve description de l\textquotesingle{}ui}{BrÃ¨ve description de l\textquotesingle{}ui}}\label{md__r_e_a_d_m_e_autotoc_md10}
Le dossier {\ttfamily /ui} contient les fichiers {\ttfamily \doxylink{ui_8cpp}{ui.\+cpp}} et {\ttfamily \doxylink{ui_8h}{ui.\+h}} permettant de crÃ©er l\textquotesingle{}interface utilisateur de jeu Ã  l\textquotesingle{}aide de la librairie {\ttfamily SFML}. Il s\textquotesingle{}agit essentiellement de la dÃ©finition et la dÃ©claration des \+:
\begin{DoxyItemize}
\item variables permettant de dÃ©finir les caractÃ©ristiques de l\textquotesingle{}interface, comme par exemple la hauteur en pixels de l\textquotesingle{}Ã©cran, au sein du namespace {\ttfamily \doxylink{namespace_u_i}{UI}} ;
\item des fonctions permettant de faciliter la manipulation de la librarie {\ttfamily SFML} dans la fonction {\ttfamily main} du jeu.
\end{DoxyItemize}

Ces Ã©lÃ©ments permettent notamment d\textquotesingle{}utiliser les classes du core pour gÃ©nÃ©rer la boucle de jeu Ã  l\textquotesingle{}aide de diverses fonctions. Ils permettent Ã©galement de fournir un affichage plein Ã©cran qui s\textquotesingle{}adapte automatiquement Ã  la rÃ©solution native de l\textquotesingle{}Ã©cran, par exemple pour le centrage des textes de menu ou sur les cÃ´tÃ©s de la grille. Mentionnons que la police d\textquotesingle{}Ã©criture utilisÃ©e tire sa source de \href{https://fontstruct.com/fontstructions/show/2350408}{\texttt{https\+://fontstruct.\+com/fontstructions/show/2350408}}. Finalement, ils permettent la diffusion de sons et musiques d\textquotesingle{}ambiance. Ils proviennent de \href{https://pixabay.com/fr/sound-effects/search/musique\%20pour\%20tetris/?utm_source=chatgpt.com}{\texttt{https\+://pixabay.\+com/fr/sound-\/effects/search/musique\%20pour\%20tetris/?utm\+\_\+source=chatgpt.\+com}} et de \href{https://www.voicy.network/fr/search/tetris-sound-effects}{\texttt{https\+://www.\+voicy.\+network/fr/search/tetris-\/sound-\/effects}}. Il n\textquotesingle{}y a cependant pas d\textquotesingle{}option de rÃ©glages des volumes sonores Ã  l\textquotesingle{}intÃ©rieur du jeu.\hypertarget{md__r_e_a_d_m_e_autotoc_md11}{}\doxysection{\texorpdfstring{Documentation}{Documentation}}\label{md__r_e_a_d_m_e_autotoc_md11}
La documentation des fichiers du jeu a Ã©tÃ© gÃ©nÃ©rÃ©e Ã  l\textquotesingle{}aide de {\ttfamily Doxygen}. Les fichiers gÃ©nÃ©rÃ©s sont au format {\ttfamily html} ou {\ttfamily Latex} au sein du fichier {\ttfamily /doc}. Le format le plus simple Ã  utiliser est le format {\ttfamily html} puisqu\textquotesingle{}il suffit de l\textquotesingle{}ouvrir dans un navigateur internet pour pouvoir en consulter le contenu.

La documentation gÃ©nÃ©rÃ©e permet d\textquotesingle{}obtenir l\textquotesingle{}ensemble des dÃ©clarations des Ã©lÃ©ments importants du jeu (classes, fonctions, namespace etc) ainsi qu\textquotesingle{}une brÃ¨ve description de ce que cela reprÃ©sente ou de ce que cela est censÃ© accomplir.\hypertarget{md__r_e_a_d_m_e_autotoc_md12}{}\doxysection{\texorpdfstring{Tests}{Tests}}\label{md__r_e_a_d_m_e_autotoc_md12}
La core du jeu a Ã©tÃ© testÃ© Ã  l\textquotesingle{}aide de la librarie {\ttfamily Catch 2}. Cela a permis l\textquotesingle{}implÃ©mentation de tests systÃ©matiques des Ã©lÃ©ments clÃ©s de la logique interne du jeu. Ces tests sont exÃ©cutables en exÃ©cutant le fichier {\ttfamily test\+\_\+core} qui a Ã©tÃ© crÃ©e au mÃªme endroit que {\ttfamily tetrix\+\_\+game} lors de l\textquotesingle{}installation.

Les premiers tests sont simplement des vÃ©rifications sommaires de la mÃ©thode {\ttfamily move} de la classe {\ttfamily \doxylink{class_block}{Block}} ainsi que de l\textquotesingle{}attribution des couleurs des blocs d\textquotesingle{}une piÃ¨ce en fonction de sa forme. Les autres tests, plus importants, consistent Ã  tester la classe {\ttfamily \doxylink{class_grid}{Grid}} puisqu\textquotesingle{}elle contient les fonctions d\textquotesingle{}interface du core. En outre, son bon fonctionnement valide Ã©galement celui des autres classes puisqu\textquotesingle{}il en dÃ©pend. La philosophie de ces tests est la suivante \+:
\begin{DoxyItemize}
\item on crÃ©e un objet de type {\ttfamily string} qui reprÃ©sente un Ã©tat du jeu bien prÃ©cis et dont l\textquotesingle{}Ã©tat peut-\/Ãªtre controlÃ© au besoin en l\textquotesingle{}affichant dans le terminal;
\item on recrÃ©e ensuite cet Ã©tat du jeu Ã  l\textquotesingle{}aide des mÃ©thodes de la classe {\ttfamily \doxylink{class_grid}{Grid}} en supposant qu\textquotesingle{}elles fonctionnent correctement;
\item on transforme la grille en objet de type {\ttfamily string} Ã  l\textquotesingle{}aide de la fonction auxiliaire {\ttfamily \doxylink{core__class_8h_a175f9fbd6504784b4f90cf8b5932dc18}{get\+\_\+grid}};
\item on rÃ©alise un test de comparaison entre les deux {\ttfamily string} ainsi obtenues \+: si le test est validÃ©, c\textquotesingle{}est que les mÃ©thodes de la {\ttfamily \doxylink{class_grid}{Grid}} en ont modifiÃ© l\textquotesingle{}Ã©tat de la faÃ§on attendue, sinon c\textquotesingle{}est qu\textquotesingle{}il y a un problÃ¨me Ã  rÃ©gler. ~\newline

\end{DoxyItemize}

~\newline


En ce qui concerne l\textquotesingle{}interface utilisateur du jeu, l\textquotesingle{}utilisation de la librairie {\ttfamily Catch 2} est beaucoup plus difficile de par l\textquotesingle{}objectif mÃªme de cette partie du code, Ã  savoir crÃ©er un affichage graphique ainsi qu\textquotesingle{}ajouter des musiques et effet sonores. Les tests ont donc Ã©tÃ© conduits plus Ã©lÃ©mentairement en jouant simplement au jeu pour vÃ©rifier le bon fonctionnement des Ã©lÃ©ments graphiques et sonores, le fonctionnement interne du jeu Ã©tant assurÃ© par les tests systÃ©matiques du core. 